# SRP_TEST
В папке screenshots скрины работы программы.

В папке src находится SRP и хеш-функция (файл Hash это реализация Sha256, ShaOne - своей).

Хеш функция:

В собственной хеш функции входное сообщение разбивается на последовательности по 512 бит и по этим последовательностям формируются 16 слов по 32 бита каждый.

Используя эти 16 слов формируются ещё 48 слов по формуле:

w[i]=((w[i-15] >> 20) xor (w[i-15]>>15) xor (w[i-15]>>30)) + w[i-15],

где w - массив этих слов, i - номер элемента, начиная с 16 до 64.

При самом хешировании используются формулы:

(a >> 10 xor b >>5 xor c >> 15 xor w[i]) + not(d),

(e >> 4 xor f >>6 xor g >> 8 xor w[i]) + not(h),

где a,b,c,d,e,f,g,h -большие простые числа, i - номер элемента от 0 до 64.

SRP:

k и g являются константами и равны 3 и 2 соотвественно.

q - случайное простое число, N = q*2+1, при этом проверяется является ли N простым.

При регистрации на стороне клиента:

Генерируется соль, x и верификатор ( Соль вычисляется как timestamp, тоесть как текущая дата)
Логин, соль и верификатор отправляются на сервер.
На стороне Сервера:

данные в виде логина, соли и верификатора заносятся в базу данных. Как база данных используется объект localStorage (данные сохраняются в браузере)
При входе пользователь:

генерирует A и отправляет его вместе с логином на сервер.
Получает от сервера соль и B, и вычисляет сессионный ключ Sc.
С помощью Sc, A и B вычисляет M1.
Вычисляет M2.
Cервер при этом:

Получает от пользователя A и логин
По логину находит в базе данных соль и верификатор, которые использует для генерации B.
Возвращает пользователю соль и B.
Вычисляет Сессионный ключ Ss и M1.
Вычисляет M2.
Если M1 и M2 у клиента и cервера сошлись, значит пользователь ввел правильные данные и произвел успешный вход.
